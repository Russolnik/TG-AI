# üîß –ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

## –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Ä–µ—à–∏—Ç—å

1. ‚ùå –û—à–∏–±–∫–∞: `Could not find the 'model_name' column` - –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é 002
2. ‚ùå FFmpeg –Ω–µ –Ω–∞–π–¥–µ–Ω - –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –≤ Supabase

### –ú–∏–≥—Ä–∞—Ü–∏—è 002 (–¥–ª—è model_name)
1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard ‚Üí SQL Editor
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ `supabase/migrations/002_add_user_model.sql`

```sql
ALTER TABLE users 
ADD COLUMN IF NOT EXISTS model_name TEXT DEFAULT 'flash';

CREATE INDEX IF NOT EXISTS idx_users_model_name ON users(model_name);
```

### –ú–∏–≥—Ä–∞—Ü–∏—è 003 (–¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ `supabase/migrations/003_add_user_parameters.sql`

```sql
CREATE TABLE IF NOT EXISTS user_parameters (
    parameter_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id BIGINT NOT NULL REFERENCES users(telegram_id) ON DELETE CASCADE,
    parameter_key TEXT NOT NULL,
    parameter_value TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(user_id, parameter_key)
);
```

## –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É—Ç–∏ –∫ FFmpeg

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—É—Ç–∏ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
- `./ffmpeg/bin/ffmpeg.exe`
- `./ffmpeg/ffmpeg.exe`
- `./ffmpeg.exe`
- `./ffmpeg-8.0/bin/ffmpeg.exe`
- `./ffmpeg-8.0/ffmpeg.exe`

**–ï—Å–ª–∏ FFmpeg –≤ –¥—Ä—É–≥–æ–π –ø–∞–ø–∫–µ**, –¥–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```env
FFMPEG_PATH=C:\code\TG-AI\–≤–∞—à–∞_–ø–∞–ø–∫–∞\ffmpeg.exe
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –µ—Å—Ç—å –ø–∞–ø–∫–∞ `ffmpeg-8.0`, –Ω–æ —Ç–∞–º —Ç–æ–ª—å–∫–æ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏. 
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `ffmpeg.exe`, –ø–æ–º–µ—Å—Ç–∏—Ç–µ –µ–≥–æ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –≤ `.env`.

## –®–∞–≥ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ö–æ–º–∞–Ω–¥–∞ `/params`
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/params` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
- –£–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫:
- **religion** - –í–µ—Ä—É—é—â–∏–π/–í–µ—Ä—É—é—â–∞—è
- **age** - –í–æ–∑—Ä–∞—Å—Ç
- **interests** - –ò–Ω—Ç–µ—Ä–µ—Å—ã
- **language** - –Ø–∑—ã–∫ –æ–±—â–µ–Ω–∏—è

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ AI, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ—Ç—É —É—á–∏—Ç—ã–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ Supabase
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/params`
4. –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, `religion: –≤–µ—Ä—É—é—â–∏–π`)
5. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É - –ø–∞—Ä–∞–º–µ—Ç—Ä –±—É–¥–µ—Ç —É—á—Ç–µ–Ω –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

